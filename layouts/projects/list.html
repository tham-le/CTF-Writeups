{{ define "main" }}
    <div class="main-content">
        <header class="page-header">
            <h1 class="page-title">{{ .Title }}</h1>
            {{ with .Content }}
                <div class="page-description">{{ . | markdownify }}</div>
            {{ end }}
        </header>

        <div class="project-grid">
            <div class="grid">
                {{ $paginator := .Paginate (where .Site.RegularPages "Section" "projects") }}
                {{ range $paginator.Pages }}
                    <a href="{{ .Permalink }}" class="card-link">
                        <div class="card">
                            <div class="card-content">
                                <div class="card-tags">
                                    <span class="card-tag">Project</span>
                                    {{ with .Params.tags }}
                                        {{ range first 1 . }}
                                            <span class="card-tag">{{ . }}</span>
                                        {{ end }}
                                    {{ end }}
                                </div>
                                <h3 class="card-title">{{ .Title }}</h3>
                                <p class="card-description">{{ .Description }}</p>
                            </div>
                        </div>
                    </a>
                {{ end }}
            </div>
        </div>

        {{ partial "pagination.html" . }}
    </div>

    {{/*
    {{ $lang := .Site.Language.Lang }}
    {{ $featuredPath := printf "config/featured-articles.%s.json" $lang }}
    {{ $defaultFeaturedPath := "config/featured-articles.json" }}
    
    {{ $featuredResource := resources.Get $featuredPath | default (resources.Get $defaultFeaturedPath) }}

    {{ if $featuredResource }}
        {{ $featuredConfig := $featuredResource | transform.Unmarshal }}
        {{ if $featuredConfig }}
            <section class="featured-section">
                <h2 class="featured-title">{{ $featuredConfig.title }}</h2>
                <p class="featured-description">{{ $featuredConfig.description }}</p>
                
                <div class="featured-grid">
                    {{ range $featuredConfig.articles }}
                        {{ if .featured }}
                            <article class="featured-card">
                                <div class="featured-image">
                                    <div class="featured-image-placeholder">
                                        <span class="featured-emoji">{{ .emoji }}</span>
                                    </div>
                                </div>
                                
                                <div class="featured-content">
                                    <h3 class="featured-card-title">
                                        <a href="{{ .url }}">{{ .title }}</a>
                                    </h3>
                                    <p class="featured-card-description">{{ .description }}</p>
                                    {{ if $featuredConfig.settings.show_category }}
                                        <span class="featured-category">{{ .category }}</span>
                                    {{ end }}
                                </div>
                            </article>
                        {{ end }}
                    {{ end }}
                </div>
            </section>
        {{ end }}
    {{ end }}
    */}}

    {{/* Display the article list as before */}}
    {{ $pages := where .Site.RegularPages "Type" "in" .Site.Params.mainSections }}
    {{ $notHidden := where .Site.RegularPages "Params.hidden" "!=" true }}
    {{ $filtered := ($pages | intersect $notHidden) }}
    {{ $pag := .Paginate ($filtered) }}

    <section class="article-list">
        {{ range $index, $element := $pag.Pages }}
            {{ partial "article-list/default" . }}
        {{ end }}
    </section>

    {{- partial "pagination.html" . -}}
    {{- partial "footer/footer" . -}}
{{ end }}

{{ define "right-sidebar" }}
    {{ partial "sidebar/right.html" (dict "Context" . "Scope" "homepage") }}
{{ end }} 